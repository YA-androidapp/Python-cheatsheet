### pathlib でのファイル操作

```py
from pathlib import Path
```

| 項目                 | 関数            | 値                                                             |
| -------------------- | --------------- | -------------------------------------------------------------- |
| カレントディレクトリ | `Path().cwd()`  | `WindowsPath('C:/Users/y/Documents/GitHub/Python-cheatsheet')` |
| ホームディレクトリ   | `Path().home()` | `WindowsPath('C:/Users/y')`                                    |

```py
from pathlib import Path

p = Path() # カレントディレクトリ
```

| 項目                                                                       | 関数                                                        | 値                                                                                                                                                                                       |
| -------------------------------------------------------------------------- | ----------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| ファイル情報                                                               | `p.stat()`                                                  | `os.stat_result(st_mode=16895, st_ino=1970324838202858, st_dev=2665268219, st_nlink=1, st_uid=0, st_gid=0, st_size=4096, st_atime=1580268901, st_mtime=1580268901, st_ctime=1564111044)` |
| 　（パスがシンボリックリンクの場合、シンボリックリンク自身の情報を取得）   | `p.lstat()`                                                 | `os.stat_result(st_mode=16895, st_ino=1970324838202858, st_dev=2665268219, st_nlink=1, st_uid=0, st_gid=0, st_size=4096, st_atime=1580268901, st_mtime=1580268901, st_ctime=1564111044)` |
|                                                                            |                                                             |                                                                                                                                                                                          |
| 相対パス                                                                   | `p`                                                         | `WindowsPath('.')`                                                                                                                                                                       |
| 絶対パス                                                                   | `p.resolve()` <br> `p.absolute()`                           | `WindowsPath('C:/Users/y/Documents/GitHub/Python-cheatsheet')`                                                                                                                           |
| パスが存在するかどうか                                                     | `p.exists()`                                                | `True`                                                                                                                                                                                   |
| パスがディレクトリ（またはディレクトリへのシンボリックリンク）             | `p.is_dir()`                                                | `True`                                                                                                                                                                                   |
| パスが一般ファイル（または一般ファイルへのシンボリックリンク）             | `p.is_file()`                                               | `False`                                                                                                                                                                                  |
| パスがシンボリックリンク                                                   | `p.is_symlink()`                                            | `False`                                                                                                                                                                                  |
| パスが Unix ソケット（または Unix ソケットへのシンボリックリンク）         | `p.is_socket()`                                             | `False`                                                                                                                                                                                  |
| パスが FIFO（または FIFO へのシンボリックリンク）                          | `p.is_fifo()`                                               | `False`                                                                                                                                                                                  |
| パスが絶対パスかどうか                                                     | `p.is_absolute()`                                           | `False`                                                                                                                                                                                  |
|                                                                            |                                                             |                                                                                                                                                                                          |
| パス文字列の連結（結合）                                                   | `Path('test-pathlib').joinpath('sub')`                      | `WindowsPath('test-pathlib/sub')`                                                                                                                                                        |
|                                                                            | `Path('c:').joinpath('/Program Files')`                     | `WindowsPath('c:/Program Files')`                                                                                                                                                        |
|                                                                            | `Path('c:/').joinpath('Program Files')`                     | `WindowsPath('c:/Program Files')`                                                                                                                                                        |
|                                                                            | `Path('c:').joinpath('Program Files')`                      | `WindowsPath('c:Program Files')`                                                                                                                                                         |
|                                                                            | `Path('c:\\').joinpath('Program Files').joinpath('Python')` | `WindowsPath('c:/Program Files/Python')`                                                                                                                                                 |
| `~` および `~user` を展開                                                  | `Path('~/work').expanduser()`                               | `WindowsPath('C:/Users/y/work')`                                                                                                                                                         |
| パス文字列のうちファイル名（basename）のみを置換                           | `Path('c:/pathlib').with_name('replaced')`                  | `WindowsPath('c:/replaced')`                                                                                                                                                             |
|                                                                            |                                                             |                                                                                                                                                                                          |
| 2 つのパス間の相対パス                                                     | `Path('/var/www/html').relative_to('/var')`                 | `WindowsPath('www/html')`                                                                                                                                                                |
|                                                                            | `Path('/var/www/html').relative_to('/etc')`                 | `ValueError: '\\var\\www\\html' does not start with '\\etc'`                                                                                                                             |
|                                                                            |                                                             |                                                                                                                                                                                          |
| モードを変更                                                               | `p.chmod(0o444)` <br> `p.stat().st_mode`                    | `16749`                                                                                                                                                                                  |
| 　（パスがシンボリックリンクの場合、シンボリックリンク自身のモードを変更） | `p.lchmod(0o444)` <br> `p.stat().st_mode`                   | `16749`                                                                                                                                                                                  |
|                                                                            |                                                             |                                                                                                                                                                                          |
| ディレクトリの内容を列挙                                                   | `for child in p.iterdir(): child`                           | `WindowsPath('.git')` <br> `WindowsPath('.gitattributes')` <br> ... <br> `WindowsPath('__pycache__')`                                                                                    |

```py
from pathlib import Path

filepath = ('./test-pathlib/test.txt')
p = Path(filepath) # ファイルのPathオブジェクト
```

| 項目                                                                                       | 関数                                        | 値                                                                                                                                                                                             |
| ------------------------------------------------------------------------------------------ | ------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| ファイル情報                                                                               | `p.stat()`                                  | `os.stat_result(st_mode=33206, st_ino=21110623253331987, st_dev=2665268219, st_nlink=1, st_uid=0, st_gid=0, st_size=533, st_atime=1580268916, st_mtime=1565394485, st_ctime=1580268916)`       |
|                                                                                            |                                             |                                                                                                                                                                                                |
| 相対パス                                                                                   | `p`                                         | `WindowsPath('test-pathlib/test.txt')`                                                                                                                                                         |
| 絶対パス                                                                                   | `p.resolve()` <br>or<br> `p.absolute()`     | `WindowsPath('C:/Users/y/Documents/GitHub/Python-cheatsheet/test-pathlib/test.txt')`                                                                                                           |
| パスが存在するかどうか                                                                     | `p.exists()`                                | `True`                                                                                                                                                                                         |
| パスがディレクトリ（またはディレクトリへのシンボリックリンク）                             | `p.is_dir()`                                | `False`                                                                                                                                                                                        |
| パスが一般ファイル（または一般ファイルへのシンボリックリンク）                             | `p.is_file()`                               | `True`                                                                                                                                                                                         |
| パスがシンボリックリンク                                                                   | `p.is_symlink()`                            | `False`                                                                                                                                                                                        |
| パスが Unix ソケット（または Unix ソケットへのシンボリックリンク）                         | `p.is_socket()`                             | `False`                                                                                                                                                                                        |
| パスが FIFO（または FIFO へのシンボリックリンク）                                          | `p.is_fifo()`                               | `False`                                                                                                                                                                                        |
| パスが絶対パスかどうか                                                                     | `p.is_absolute()`                           | `False`                                                                                                                                                                                        |
| パス文字列の連結（結合）                                                                   | `Path('test-pathlib').joinpath('test.txt')` | `WindowsPath('test-pathlib/test.txt')`                                                                                                                                                         |
| パス文字列のうちファイル名（basename）のみを置換                                           | `p.with_name('replaced.txt')`               | `WindowsPath('test-pathlib/replaced.txt')`                                                                                                                                                     |
| パス文字列のうち拡張子のみを置換                                                           | `p.with_suffix('.txt')`                     | `WindowsPath('test-pathlib/test.txt')`                                                                                                                                                         |
| 2 つのパス間の相対パス                                                                     | `Path('/etc/passwd').relative_to('/etc')`   | `WindowsPath('passwd')`                                                                                                                                                                        |
|                                                                                            |                                             |                                                                                                                                                                                                |
| スラッシュ区切りのパス                                                                     | `Path('c:\\windows').resolve().as_posix()`  | `'C:/Windows'`                                                                                                                                                                                 |
| file URI                                                                                   | `p.resolve().as_uri()`                      | `'file:///C:/Users/y/Documents/GitHub/Python-cheatsheet/test-pathlib/test.txt'`                                                                                                                |
|                                                                                            |                                             |                                                                                                                                                                                                |
| ドライブ文字                                                                               | `p.resolve().drive`                         | `'C:'`                                                                                                                                                                                         |
| ルート                                                                                     | `p.resolve().root`                          | `\\`                                                                                                                                                                                           |
| アンカー（ドライブ文字＋ルート）                                                           | `p.resolve().anchor`                        | `C:\\`                                                                                                                                                                                         |
| 上位パスを辿る                                                                             | `p.resolve().parents`                       | `<WindowsPath.parents>`                                                                                                                                                                        |
|                                                                                            | `[i for i in p.resolve().parents]`          | `[WindowsPath('C:/Users/y/Documents/GitHub/Python-cheatsheet/test-pathlib'), WindowsPath('C:/Users/y/Documents/GitHub/Python-cheatsheet'),` ... `WindowsPath('C:/Users'), WindowsPath('C:/')]` |
| 上位パス                                                                                   | `p.resolve().parent`                        | `WindowsPath('C:/Users/y/Documents/GitHub/Python-cheatsheet/test-pathlib')`                                                                                                                    |
|                                                                                            | `Path('/').parent`                          | `WindowsPath('/')` 親ディレクトリが存在しない場合                                                                                                                                              |
|                                                                                            | `Path('.').parent`                          | `WindowsPath('.')` 空のパス                                                                                                                                                                    |
|                                                                                            | `Path('.').resolve().parent`                | `WindowsPath('C:/Users/y/Documents/GitHub')`                                                                                                                                                   |
|                                                                                            |                                             |                                                                                                                                                                                                |
| ファイル名（basename）                                                                     | `p.resolve().name`                          | `'test.txt'`                                                                                                                                                                                   |
| 拡張子                                                                                     | `p.resolve().suffix`                        | `'.txt'`                                                                                                                                                                                       |
|                                                                                            | `Path('test.tar.gz').resolve().suffix`      | `'.gz'`                                                                                                                                                                                        |
| 拡張子のリスト                                                                             | `p.resolve().suffixes`                      | `['.txt']`                                                                                                                                                                                     |
|                                                                                            | `Path('test.tar.gz').resolve().suffixes`    | `['.tar', '.gz']`                                                                                                                                                                              |
| ファイル名から拡張子を除いたもの                                                           | `p.resolve().stem`                          | `'test'`                                                                                                                                                                                       |
|                                                                                            |                                             |                                                                                                                                                                                                |
| glob 形式のパターンにマッチするか                                                          | `p.match('*.txt')`                          | `True`                                                                                                                                                                                         |
| 　（pattern が相対表記であればパスは相対／絶対パスを取り、右から一致を調べる）             | `Path('/a/b/c.py').match('b/*.py')`         | `True`                                                                                                                                                                                         |
|                                                                                            | `Path('/a/b/c.py').match('a/*.py')`         | `False`                                                                                                                                                                                        |
| 　（pattern が絶対表記であればパスは絶対パスでなければならず、パス全体が一致するか調べる） | `Path('/a.py').match('/*.py')`              | `True`                                                                                                                                                                                         |
|                                                                                            | `Path('a/b.py').match('/*.py')`             | `False`                                                                                                                                                                                        |
| 　（大文字／小文字の区別）                                                                 | `Path('b.py').match('*.PY')`                | `True` (Windows の場合)                                                                                                                                                                        |
|                                                                                            | `p`                                         | `p`                                                                                                                                                                                            |
|                                                                                            |                                             |                                                                                                                                                                                                |
| モードを変更（chmod）                                                                      | `p.chmod(0o444)` <br> `p.stat().st_mode`    | `33060`                                                                                                                                                                                        |

| stat の項目 | 説明                             |
| ----------- | -------------------------------- |
| `st_mode`   | ファイルモード                   |
| `st_ino`    | inode 番号（Unix）               |
|             | the file index（Windows）        |
| `st_dev`    | デバイスの識別子                 |
| `st_nlink`  | ハードリンクの数                 |
| `st_uid`    | ファイル所有者のユーザ識別子     |
| `st_gid`    | ファイル所有者のグループ識別子   |
| `st_size`   | バイト単位でのファイルサイズ     |
| `st_atime`  | 秒で表した最終アクセス時刻       |
| `st_mtime`  | 秒で表した最終更新時刻           |
| `st_ctime`  | メタデータの最終更新時刻（Unix） |
|             | 秒で表した作成時刻（Windows）    |
